@import controllers.project.{routes => projectRoutes}
@import db.ModelService
@import discourse.OreDiscourseApi
@import models.user.role.ProjectRole
@import ore.OreConfig
@import ore.project.factory.PendingProject
@import play.twirl.api.Html
@import views.html.helper.form

@import scala.collection.JavaConverters._
@import scala.concurrent.TimeoutException
@import views.html.helper.CSRF
@import models.user.User
@import models.viewhelper.HeaderData
@import scala.concurrent.ExecutionContext
@(pending: PendingProject, userList: List[User], registeredUsers: Int, headerData: HeaderData)(implicit executionContext: ExecutionContext, messages: Messages, flash: Flash, request: Request[_], service: ModelService,
        forums: OreDiscourseApi, config: OreConfig, currentUser: User)

@projects.helper.panelCreate(messages("project.create"), 3, headerData: HeaderData) {
    <!-- Start panel -->
    <div class="panel-body">
        <!-- Info -->
        <div class="minor create-blurb">
            <p>@messages("project.members.infoText.head")</p>
            <p>
                @Html(messages("project.members.infoText.bottom", registeredUsers))
            </p>
        </div>

        @users.invite.form(
            owner = service.await(pending.underlying.owner.user).get,
            loadedUsers = userList,
            roleClass = classOf[ProjectRole]
        )

        <!-- Submission form -->
        @form(action = projectRoutes.Projects.showFirstVersionCreator(
            pending.underlying.ownerName,
            pending.underlying.slug),
            'id -> "form-continue") {

            @CSRF.formField

            <div class="btn-group pull-right">
                <a href="@projectRoutes.Projects.showCreatorWithMeta(
                    pending.underlying.ownerName,
                    pending.underlying.slug)"
                   title="Back" class="pull-left btn btn-default">
                    <i class="fa fa-arrow-left"></i>
                </a>

                @* Disabled until JS determines meta is valid *@
                <button title="Continue" type="submit" name="submit" value="@messages("general.continue")"
                        class="pull-right continue-btn btn btn-primary">
                    <i class="fa fa-arrow-right"></i>
                </button>
            </div>

        }

    </div>
}
